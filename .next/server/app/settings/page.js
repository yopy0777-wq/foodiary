(()=>{var e={};e.id=938,e.ids=[938],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},6118:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>c});var r=s(482),a=s(9108),n=s(2563),l=s.n(n),i=s(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9700)),"C:\\Tools\\foodiary\\src\\app\\settings\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,6313)),"C:\\Tools\\foodiary\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Tools\\foodiary\\src\\app\\settings\\page.tsx"],x="/settings/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/settings/page",pathname:"/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8275:(e,t,s)=>{Promise.resolve().then(s.bind(s,922))},922:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5344),a=s(3729),n=s(6506),l=s(2070),i=s(333),o=s(5814);let c=()=>!1,d=e=>"free"!==e&&c(),x=e=>({free:"フリープラン",member:"無料会員",premium:"プレミアム"})[e],m=e=>({free:"PWA保存のみ。手動バックアップ可能。",member:"ローカルフォルダへの自動保存が利用可能。",premium:"クラウド保存で複数デバイス間同期が可能。"})[e],u={free:"bg-gray-100 text-gray-600 border-gray-200",member:"bg-green-100 text-green-600 border-green-200",premium:"bg-yellow-100 text-yellow-600 border-yellow-200"};function h(){let{user:e,plan:t,isAuthenticated:c,signOut:h}=(0,o.useAuth)(),[g,p]=(0,a.useState)(!1),[y,f]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),[w,P]=(0,a.useState)(null),C=(0,a.useRef)(null),k=d(t);(0,a.useEffect)(()=>{(async()=>{let e=(0,i.DB)();p(e),e&&f(await (0,i.OK)()),j(!1)})()},[]);let _=(e,t)=>{P({type:e,text:t}),setTimeout(()=>P(null),3e3)},q=async()=>{try{if(await (0,i.j7)()){f(!0),_("success","フォルダを設定しました。データが自動保存されます。");let e=await (0,l.C0)();if(e.length>0){let{saveToFile:t}=await Promise.resolve().then(s.bind(s,333));await t(e)}}}catch(e){console.error("フォルダ選択に失敗しました:",e),_("error","フォルダの選択に失敗しました")}},E=async()=>{confirm("フォルダ設定を解除しますか？\n（保存済みのファイルは削除されません）")&&(await (0,i.vU)(),f(!1),_("success","フォルダ設定を解除しました"))},S=async()=>{if(confirm("ファイルからデータを読み込みますか？\n現在のデータはファイルの内容で上書きされます。")){N(!0);try{let e=await (0,i.eR)();if(null===e){_("error","ファイルの読み込みに失敗しました");return}await (0,l.Ps)(),e.length>0&&await (0,l.PZ)(e),_("success",`${e.length}件のデータを読み込みました`)}catch(e){console.error("同期に失敗しました:",e),_("error","同期に失敗しました")}finally{N(!1)}}},$=async()=>{try{let e=await (0,l.C0)();await (0,i.VE)(e),_("success","データをエクスポートしました")}catch(e){console.error("エクスポートに失敗しました:",e),_("error","エクスポートに失敗しました")}},A=async e=>{let t=e.target.files?.[0];if(t){if(!confirm("ファイルからデータをインポートしますか？\n同じIDのデータは上書きされます。")){e.target.value="";return}try{let e=await (0,i.Is)(t);await (0,l.PZ)(e),_("success",`${e.length}件のデータをインポートしました`)}catch(e){console.error("インポートに失敗しました:",e),_("error","インポートに失敗しました。ファイル形式を確認してください。")}finally{e.target.value=""}}},G=async()=>{confirm("ログアウトしますか？")&&(await h(),_("success","ログアウトしました"))};return r.jsx("main",{className:"min-h-screen bg-gradient-to-b from-green-50 to-white",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[(0,r.jsxs)("header",{className:"mb-8 flex items-center",children:[r.jsx(n.default,{href:"/",className:"mr-4 text-gray-600 hover:text-gray-800 transition",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),r.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"設定"})]}),w&&r.jsx("div",{className:`mb-6 p-4 rounded-lg ${"success"===w.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.text}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("section",{className:"bg-white rounded-2xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"アカウント"}),c?(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-800 font-medium",children:e?.email}),r.jsx("span",{className:`inline-block mt-1 px-3 py-1 text-sm font-medium rounded-full border ${u[t]}`,children:x(t)})]})}),r.jsx("p",{className:"text-sm text-gray-600",children:m(t)}),"premium"!==t&&r.jsx(n.default,{href:"/premium",className:"inline-block px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition text-sm",children:"プレミアムにアップグレード"}),r.jsx("div",{className:"pt-4 border-t",children:r.jsx("button",{onClick:G,className:"text-red-600 hover:text-red-700 text-sm",children:"ログアウト"})})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center",children:r.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${u.free}`,children:x("free")})}),r.jsx("p",{className:"text-sm text-gray-600",children:m("free")}),r.jsx("p",{className:"text-gray-600",children:"会員登録すると、ローカルフォルダへの自動保存など便利な機能が使えます。"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(n.default,{href:"/auth/login",className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition text-sm",children:"ログイン"}),r.jsx(n.default,{href:"/auth/signup",className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition text-sm",children:"新規登録"})]})]})]}),(0,r.jsxs)("section",{className:"bg-white rounded-2xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"自動保存"}),b?r.jsx("div",{className:"text-gray-600",children:"読み込み中..."}):k?g?y?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"自動保存が有効です"})]}),r.jsx("p",{className:"text-sm text-gray-600",children:"データは自動的にローカルフォルダに保存されます。"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:S,disabled:v,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition",children:v?"読み込み中...":"ファイルから読み込む"}),r.jsx("button",{onClick:E,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition",children:"設定を解除"})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"フォルダを選択すると、データが自動的にローカルファイルに保存されます。 ブラウザのデータを削除しても、ファイルからデータを復元できます。"}),r.jsx("button",{onClick:q,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition",children:"保存フォルダを選択"})]}):(0,r.jsxs)("div",{className:"text-gray-600",children:[r.jsx("p",{className:"mb-2",children:"このブラウザは自動保存に対応していません。"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Chrome または Edge を使用すると、ローカルフォルダへの自動保存が利用できます。"})]}):(0,r.jsxs)("div",{className:"text-gray-600",children:[r.jsx("p",{className:"mb-2",children:"この機能を使うには会員登録が必要です。"}),!g&&r.jsx("p",{className:"text-sm text-gray-500",children:"また、Chrome または Edge を使用する必要があります。"}),!c&&r.jsx(n.default,{href:"/auth/signup",className:"inline-block mt-3 text-green-600 hover:underline text-sm",children:"会員登録して機能を解放"})]})]}),(0,r.jsxs)("section",{className:"bg-white rounded-2xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"手動バックアップ"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"全ブラウザ対応。JSONファイルとしてデータをダウンロード・復元できます。"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:$,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:"データをエクスポート"}),r.jsx("button",{onClick:()=>{C.current?.click()},className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition",children:"データをインポート"}),r.jsx("input",{ref:C,type:"file",accept:".json",onChange:A,className:"hidden"})]})]})]})]})})}},9700:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let r=(0,s(6843).createProxy)(String.raw`C:\Tools\foodiary\src\app\settings\page.tsx`),{__esModule:a,$$typeof:n}=r,l=r.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,505,419,284],()=>s(6118));module.exports=r})();