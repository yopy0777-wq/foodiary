(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8529:function(e,t,r){Promise.resolve().then(r.bind(r,5096))},5096:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=r(3827),n=r(4090),s=r(3669);function l(e){let{entry:t,onDelete:r}=e,[s,l]=(0,n.useState)("");return(0,n.useEffect)(()=>{if(t.photo){let e=URL.createObjectURL(t.photo);return l(e),()=>URL.revokeObjectURL(e)}},[t.photo]),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[s&&(0,a.jsx)("div",{className:"w-full h-64 bg-gray-100",children:(0,a.jsx)("img",{src:s,alt:t.menuName,className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:t.menuName}),(0,a.jsx)("button",{onClick:()=>r(t.id),className:"text-red-500 hover:text-red-700 transition p-2 hover:bg-red-50 rounded-lg",title:"削除",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),(0,a.jsxs)("p",{className:"text-gray-600 flex items-center",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"short"})]})]})]})}var o=r(8792);function i(){return(0,a.jsx)(o.default,{href:"/add",className:"fixed bottom-6 right-6 bg-green-500 hover:bg-green-600 text-white rounded-full p-4 shadow-2xl transition transform hover:scale-110 active:scale-95 z-50",children:(0,a.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}function c(){let[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),c=async()=>{try{let e=await (0,s.C0)();t(e)}catch(e){console.error("データの読み込みに失敗しました:",e)}finally{o(!1)}};(0,n.useEffect)(()=>{c()},[]);let d=async e=>{if(confirm("この記録を削除しますか?"))try{await (0,s.pO)(e),await c()}catch(e){console.error("削除に失敗しました:",e),alert("削除に失敗しました")}};return(0,a.jsxs)("main",{className:"min-h-screen bg-gradient-to-b from-green-50 to-white pb-20",children:[(0,a.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"\uD83C\uDF7D️ 食事記録"}),(0,a.jsx)("p",{className:"text-gray-600",children:"食べたものを記録しよう"})]}),r?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("p",{className:"text-6xl mb-4",children:"\uD83D\uDCDD"}),(0,a.jsx)("p",{className:"text-gray-600 mb-2",children:"まだ記録がありません"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"右下のボタンから記録を追加しましょう"})]}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsx)(l,{entry:e,onDelete:d},e.id))})]}),(0,a.jsx)(i,{})]})}},3669:function(e,t,r){"use strict";r.d(t,{C0:function(){return i},hv:function(){return d},pO:function(){return c},px:function(){return o}});var a=r(7012);let n="entries",s=null,l=()=>(s||(s=(0,a.X3)("FoodDiaryDB",1,{upgrade(e){e.objectStoreNames.contains(n)||e.createObjectStore(n,{keyPath:"id"}).createIndex("by-date","date")}})),s),o=async e=>{let t=await l();await t.add(n,e)},i=async()=>{let e=await l();return(await e.getAllFromIndex(n,"by-date")).reverse()},c=async e=>{let t=await l();await t.delete(n,e)},d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:800,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;return new Promise((n,s)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=e=>{var l;let o=new Image;o.src=null===(l=e.target)||void 0===l?void 0:l.result,o.onload=()=>{let e=document.createElement("canvas"),l=o.width,i=o.height;l>i?l>t&&(i*=t/l,l=t):i>r&&(l*=r/i,i=r),e.width=l,e.height=i;let c=e.getContext("2d");null==c||c.drawImage(o,0,0,l,i),e.toBlob(e=>{e?n(e):s(Error("画像の圧縮に失敗しました"))},"image/jpeg",a)},o.onerror=s},l.onerror=s})}}},function(e){e.O(0,[746,971,69,744],function(){return e(e.s=8529)}),_N_E=e.O()}]);